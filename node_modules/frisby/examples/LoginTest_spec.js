
var frisby = require('../lib/frisby');

// Global setup for all tests
frisby.globalSetup({
  request: {
    headers:{'Accept': 'application/json'}
  }
});


// Test reponse
frisby.create('Get Login Token')
  .post('https://et2-fasttrackapi.ttlnonprod.com/v1/Login', {username: "sudhanva.m@thetrainline.com", password: "password", ManagedGroupId: 20})
  .expectStatus(200)
  .expectJSONTypes({
    DeviceFingerPrint: null,
    Customer: {
      ForeName: String,
      SurName: String,
      CustomerId: String,
      EmailAddress: String,
      Token: {
        Token: String,
        TokenExpiryTime: String
      },
      Address: {
        Line1: String,
        Line2: String,
        Line3: null,
        Line4: null,
        Line5: null,
        Postcode: String,
        Country: String
      },
      IsImplicitCustomer: Boolean,
      HasErrors: Boolean,
      WsgErrors: null
    },
    IsLoggedIn: Boolean,
    DeviceFingerPrintData: {
      Hostname: String,
      OriginId: String,
      MerchantId: String,
      TransactionId: String,
      TransactionDate: String
    },
    HasErrors: Boolean,
    WsgErrors: null
  })
  .afterJSON(function (body){
    expect(body.Customer.EmailAddress).toMatch('SUDHANVA.M@THETRAINLINE.COM')
  })
.toss();


// Navigate to this folder and execute jasmine-node LoginTest_spec.js